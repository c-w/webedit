(this.webpackJsonpwebedit=this.webpackJsonpwebedit||[]).push([[0],{393:function(e,t,a){e.exports=a(662)},662:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(17),o=a.n(c),s=a(25),i=a(349),l=a(24),u=a(69),m=a(715),p=a(379),b=a(58),f=Object(b.b)({name:"user",initialState:null,reducers:{login:function(e,t){return t.payload},logout:function(e,t){return null}}}),d=f.actions,h=d.login,v=d.logout,g=function(e){return e.user},x=f.reducer;function E(e){var t=e.component,a=Object(p.a)(e,["component"]),n=Object(s.c)(g);return r.a.createElement(l.b,Object.assign({},a,{render:function(e){return null!=n?r.a.createElement(t,e):r.a.createElement(l.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}var k=a(70),j=a(716),O=a(705),y=a(720),w=a(709),N=a(718),S=a(676),A=a(708),_=a(707),C=a(254),F=a(255),B=a(256),D=a(257),T=a(352),G=a.n(T),I=a(350),J=a.n(I),z=a(719),P=a(351),W=a.n(P),L=a(706),R=a(95),H=a(703),U=Object(b.b)({name:"alert",initialState:null,reducers:{set:function(e,t){return t.payload},clear:function(e,t){return null}}}),q=U.actions,K=q.set,M=q.clear,V=function(e){return e.alert},$=U.reducer,Q=Object(b.b)({name:"loading",initialState:!1,reducers:{set:function(e,t){return t.payload}}}),X=Q.actions.set,Y=function(e){return e.loading},Z=Q.reducer,ee=Object(b.b)({name:"repos",initialState:[],reducers:{add:function(e,t){return e.concat(t.payload)},clear:function(e,t){return[]}}}),te=ee.actions,ae=te.add,ne=te.clear,re=function(e){return e.repos},ce=ee.reducer,oe=Object(H.a)((function(e){return{root:{flexGrow:1},list:{width:250},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},appBarSpacer:e.mixins.toolbar}}));function se(e){var t=e.children,a=Object(s.c)(V),c=Object(s.c)(g),o=Object(s.c)(Y),i=Object(s.b)(),l=oe(),m=Object(n.useState)(!1),p=Object(k.a)(m,2),b=p[0],f=p[1],d=function(e){var t=e.type,a=e.key;("keydown"!==t||"Tab"!==a&&"Shift"!==a)&&f(!1)},h=function(){i(M())};return r.a.createElement("div",{className:l.root},r.a.createElement(O.a,null,r.a.createElement(L.a,null,r.a.createElement(S.a,{edge:"start",className:l.menuButton,color:"inherit",onClick:function(){null!=c&&f(!0)}},r.a.createElement(J.a,null)),r.a.createElement(N.a,{anchor:"left",open:b,onClose:d},r.a.createElement("div",{className:l.list,role:"presentation",onClick:d,onKeyDown:d},r.a.createElement(C.a,null,r.a.createElement(F.a,{button:!0,onClick:function(){return i(ne())}},r.a.createElement(B.a,null,r.a.createElement(W.a,null)),r.a.createElement(D.a,{primary:"Sync account"})),r.a.createElement(F.a,{button:!0,onClick:function(){return i(v())}},r.a.createElement(B.a,null,r.a.createElement(G.a,null)),r.a.createElement(D.a,{primary:"Log out"}))))),r.a.createElement(R.a,{variant:"h6",className:l.title},r.a.createElement(_.a,{to:"/home",color:"inherit",component:u.b},"WebEdit")),r.a.createElement(y.a,{alt:null===c||void 0===c?void 0:c.name,src:null===c||void 0===c?void 0:c.avatar}))),r.a.createElement("main",{className:l.content},r.a.createElement("div",{className:l.appBarSpacer}),r.a.createElement(A.a,{style:{visibility:o?"visible":"hidden"}}),r.a.createElement(w.a,{maxWidth:"lg",className:l.container},t,r.a.createElement(z.a,{open:null!=a,autoHideDuration:6e3,onClose:h},a&&r.a.createElement(j.a,{onClose:h,severity:a.severity},a.message)))))}var ie=a(34),le=a.n(ie),ue=a(66),me=a(712),pe=a(372),be=a.n(pe),fe=a(353),de=a.n(fe),he=a(370),ve=a(378),ge=a(371),xe=a(244),Ee=a(380),ke="https://api.github.com",je="application/vnd.github.v3+json";function Oe(e,t,a){return ye.apply(this,arguments)}function ye(){return(ye=Object(ue.a)(le.a.mark((function e(t,a,n){var r,c;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(ke,"/repos/").concat(a.owner,"/").concat(a.name,"/contents/").concat(n),{headers:{Authorization:"token ".concat(t),Accept:je}});case 2:return r=e.sent,e.next=5,r.json();case 5:if(c=e.sent,r.ok){e.next=8;break}throw new Error(c.message);case 8:return e.abrupt("return",{text:atob(c.content),sha:c.sha});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function we(e,t,a,n){return Ne.apply(this,arguments)}function Ne(){return(Ne=Object(ue.a)(le.a.mark((function e(t,a,n,r){var c,o;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(ke,"/repos/").concat(a.owner,"/").concat(a.name,"/contents/").concat(n),{method:"PUT",body:JSON.stringify({message:r.message||"Updates",content:btoa(r.text),sha:r.sha}),headers:{Authorization:"token ".concat(t),Accept:je}});case 2:return c=e.sent,e.next=5,c.json();case 5:if(o=e.sent,c.ok){e.next=8;break}throw new Error(o.message);case 8:return e.abrupt("return",{sha:o.content.sha});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Se(e){return Ae.apply(this,arguments)}function Ae(){return(Ae=Object(Ee.a)(le.a.mark((function e(t){var a,n,r,c,o,s,i,l,u;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="".concat(ke,"/user/repos?sort=pushed&per_page=").concat(50);case 1:if(!a){e.next=31;break}return e.next=4,Object(xe.a)(fetch(a,{headers:{Authorization:"token ".concat(t),Accept:je}}));case 4:return c=e.sent,e.next=7,Object(xe.a)(c.json());case 7:if(o=e.sent,c.ok){e.next=10;break}throw new Error(o.message);case 10:s=Object(ge.a)(o),e.prev=11,s.s();case 13:if((i=s.n()).done){e.next=19;break}return l=i.value,e.next=17,{owner:l.owner.login,name:l.name,description:l.description,active:!l.archived&&!l.disabled};case 17:e.next=13;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(11),s.e(e.t0);case 24:return e.prev=24,s.f(),e.finish(24);case 27:u=c.headers.get("link"),a=null===(n=u.match(Object(ve.a)(/<((?:(?!>)[\s\S])+)>;[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*rel="next"/,{url:1})))||void 0===n||null===(r=n.groups)||void 0===r?void 0:r.url,e.next=1;break;case 31:case"end":return e.stop()}}),e,null,[[11,21,24,27]])})))).apply(this,arguments)}function _e(e){return Ce.apply(this,arguments)}function Ce(){return(Ce=Object(ue.a)(le.a.mark((function e(t){var a,n;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(ke,"/user"),{headers:{Authorization:"token ".concat(t),Accept:je}});case 2:return a=e.sent,e.next=5,a.json();case 5:if(n=e.sent,a.ok){e.next=8;break}throw new Error(n.message);case 8:return e.abrupt("return",{name:n.name||n.login,avatar:n.avatar_url,token:t,scopes:a.headers.get("x-oauth-scopes").split(", ")});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Fe=Object(H.a)((function(e){return{icon:{marginRight:e.spacing(1)},submit:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)}}}));function Be(){var e,t=Fe(),a=Object(l.h)(),c=a.owner,o=a.name,i=a.fileName,u=Object(s.c)(g),m=Object(s.c)(re),p=Object(s.c)(Y),b=Object(s.b)(),f=Object(n.useState)(),d=Object(k.a)(f,2),h=d[0],v=d[1],x=null===(e=m.find((function(e){var t=e.repo;return t.owner===c&&t.name===o})))||void 0===e?void 0:e.config[i],E=function(){var e=Object(ue.a)(le.a.mark((function e(){var t,a,n,r,s;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p){e.next=2;break}return e.abrupt("return");case 2:return b(X(!0)),t={owner:c,name:o},e.prev=4,e.next=7,Oe(u.token,t,i);case 7:n=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),a={message:e.t0.message,severity:"error"};case 13:if(!n){e.next=26;break}return r=JSON.parse(n.text),(x.path?he.search(r,x.path):r).unshift(h),s={text:JSON.stringify(r,null,2),sha:n.sha},e.prev=18,e.next=21,we(u.token,t,i,s);case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(18),a={message:e.t1.message,severity:"error"};case 26:a||(v(null),a={message:"Item saved",severity:"success"}),b(K(a)),b(X(!1));case 29:case"end":return e.stop()}}),e,null,[[4,10],[18,23]])})));return function(){return e.apply(this,arguments)}}();return x?r.a.createElement(r.a.Fragment,null,r.a.createElement(de.a,{disabled:p,schema:x.schema,uiSchema:x.ui,formData:h,onChange:function(e){v(e.formData)},onSubmit:E},r.a.createElement(me.a,{variant:"extended",type:"submit",color:"primary",disabled:p,className:t.submit},r.a.createElement(be.a,{className:t.icon})," Save"))):r.a.createElement(l.a,{to:"/home"})}var De=a(373),Te=a(713),Ge=a(714),Ie=a(374),Je=a.n(Ie),ze=a(375),Pe=a.n(ze),We=Object(H.a)((function(e){return{root:{display:"inline-flex",marginLeft:e.spacing(1),marginRight:e.spacing(1),marginBottom:e.spacing(1)},details:{display:"flex",flexDirection:"column"},content:{flex:"1 0 auto"},controls:{display:"flex",alignItems:"center",paddingLeft:e.spacing(1),paddingBottom:e.spacing(1)}}}));function Le(e){var t=e.repo,a=e.fileName,n=We(),c="https://github.com/".concat(t.owner,"/").concat(t.name),o="/edit/".concat(t.owner,"/").concat(t.name,"/").concat(a);return r.a.createElement(Te.a,{className:n.root},r.a.createElement("div",{className:n.details},r.a.createElement(Ge.a,{className:n.content},r.a.createElement(R.a,{component:"h5",variant:"h5"},t.owner," / ",t.name," / ",a.replace(/\.json$/,"")),r.a.createElement(R.a,{variant:"subtitle1",color:"textSecondary"},t.description)),r.a.createElement("div",{className:n.controls},r.a.createElement(_.a,{to:o,component:u.b},r.a.createElement(S.a,{"aria-label":"Edit file"},r.a.createElement(Je.a,null))),r.a.createElement(_.a,{href:c,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(S.a,{"aria-label":"Open repository on GitHub"},r.a.createElement(Pe.a,null))))))}function Re(){var e=Object(s.c)(g),t=Object(s.c)(re),a=Object(s.b)();return Object(n.useEffect)((function(){Object(ue.a)(le.a.mark((function n(){var r,c,o,s,i,l,u,m,p;return le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.length&&e.token){n.next=2;break}return n.abrupt("return");case 2:a(X(!0)),r=Se(e.token),c=[],o=!0,s=!1,n.prev=7,l=function(){var t=p;if(!t.active)return"continue";c.push(Oe(e.token,t,".webedit.json").then((function(e){var n=JSON.parse(e.text);a(ae({repo:t,config:n}))})).catch((function(e){return"Not Found"===e.message||"This repository is empty."===e.message?Promise.resolve():Promise.reject(e)})))},u=Object(De.a)(r);case 10:return n.next=12,u.next();case 12:return m=n.sent,o=m.done,n.next=16,m.value;case 16:if(p=n.sent,o){n.next=24;break}if("continue"!==l()){n.next=21;break}return n.abrupt("continue",21);case 21:o=!0,n.next=10;break;case 24:n.next=30;break;case 26:n.prev=26,n.t0=n.catch(7),s=!0,i=n.t0;case 30:if(n.prev=30,n.prev=31,o||null==u.return){n.next=35;break}return n.next=35,u.return();case 35:if(n.prev=35,!s){n.next=38;break}throw i;case 38:return n.finish(35);case 39:return n.finish(30);case 40:return n.prev=40,n.next=43,Promise.all(c);case 43:n.next=48;break;case 45:n.prev=45,n.t1=n.catch(40),a(K({message:n.t1.message,severity:"error"}));case 48:a(X(!1));case 49:case"end":return n.stop()}}),n,null,[[7,26,30,40],[31,,35,39],[40,45]])})))()}),[e,t,a]),t.flatMap((function(e){var t=e.repo,a=e.config;return Object.entries(a).map((function(e){var a=Object(k.a)(e,2),n=a[0],r=a[1];return{repo:t,fileName:n,settings:r,key:"".concat(t.owner,"/").concat(t.name,"/").concat(n)}}))})).map((function(e){return r.a.createElement(Le,e)}))}var He=a(334),Ue=a(347),qe=a(376),Ke=a.n(qe),Me=Object(H.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},title:{textAlign:"center"},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function Ve(){var e=Object(l.f)(),t=Object(l.g)(),a=Object(s.b)(),c=Object(s.c)(Y),o=Object(n.useState)(""),i=Object(k.a)(o,2),u=i[0],m=i[1],p=Object(n.useState)(),b=Object(k.a)(p,2),f=b[0],d=b[1],v=Me(),g=function(){var n=Object(ue.a)(le.a.mark((function n(r){var c,o,s,i;return le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.preventDefault(),a(X(!0)),n.prev=2,n.next=5,_e(u);case 5:c=n.sent,n.next=11;break;case 8:n.prev=8,n.t0=n.catch(2),o=n.t0.message;case 11:a(X(!1)),c&&!c.scopes.some((function(e){return e.includes("repo")}))&&(o="Access token must have repo or public_repo scope"),o?d(o):(a(h(c)),e.push((null===(s=t.state)||void 0===s||null===(i=s.from)||void 0===i?void 0:i.pathname)||"/"));case 14:case"end":return n.stop()}}),n,null,[[2,8]])})));return function(e){return n.apply(this,arguments)}}();return r.a.createElement(w.a,{component:"main",maxWidth:"xs"},r.a.createElement("div",{className:v.paper},r.a.createElement(y.a,{className:v.avatar},r.a.createElement(Ke.a,null)),r.a.createElement(R.a,{component:"h1",variant:"h5",className:v.title},"Provide a Github personal access token to continue"),r.a.createElement("form",{className:v.form,noValidate:!0,onSubmit:g},r.a.createElement(Ue.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"github_personal_access_token",name:"github_personal_access_token",label:"Github personal access token",type:"password",autoComplete:"github_personal_access_token",autoFocus:!0,value:u,onChange:function(e){m(e.target.value)},disabled:c,error:null!=f,helperText:f}),r.a.createElement(He.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:v.submit,disabled:c},"Sign In"))))}var $e=function(){return r.a.createElement(l.a,{to:"/home"})};function Qe(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,null),r.a.createElement(u.a,null,r.a.createElement(se,null,r.a.createElement(l.b,{exact:!0,path:"/",component:$e}),r.a.createElement(E,{exact:!0,path:"/home",component:Re}),r.a.createElement(E,{exact:!0,path:"/edit/:owner/:name/:fileName",component:Be}),r.a.createElement(l.b,{exact:!0,path:"/login",component:Ve}))))}var Xe=a(39),Ye=a(71),Ze=a(377),et=Object(Xe.c)({alert:$,loading:Z,user:x,repos:ce}),tt={key:"root",storage:Ze},at=Object(b.a)({reducer:Object(Ye.g)(tt,(function(e,t){return t.type===v.type&&(tt.storage.removeItem("persist:".concat(tt.key)),e=void 0),et(e,t)})),middleware:Object(b.c)({serializableCheck:{ignoredActions:[Ye.a,Ye.f,Ye.b,Ye.c,Ye.d,Ye.e]}})}),nt=Object(Ye.h)(at),rt=at;o.a.render(r.a.createElement(s.a,{store:rt},r.a.createElement(i.a,{persistor:nt,loading:null},r.a.createElement(Qe,null))),document.getElementById("root"))}},[[393,1,2]]]);
//# sourceMappingURL=main.e0571ab9.chunk.js.map