(this.webpackJsonpwebedit=this.webpackJsonpwebedit||[]).push([[0],{660:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),o=n.n(c),i=n(25),s=n(351),l=n(24),u=n(69),m=n(715),p=n(380),f=n(58),d=Object(f.b)({name:"user",initialState:null,reducers:{login:function(e,t){return t.payload},logout:function(e,t){return null}}}),b=d.actions,h=b.login,v=b.logout,g=function(e){return e.user},x=d.reducer;function E(e){var t=e.component,n=Object(p.a)(e,["component"]),a=Object(i.c)(g);return r.a.createElement(l.b,Object.assign({},n,{render:function(e){return null!=a?r.a.createElement(t,e):r.a.createElement(l.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}var w=n(70),k=n(716),j=n(705),y=n(720),O=n(709),N=n(718),S=n(676),A=n(708),C=n(707),W=n(256),_=n(257),B=n(258),T=n(259),F=n(354),D=n.n(F),P=n(352),G=n.n(P),I=n(719),J=n(353),R=n.n(J),z=n(706),L=n(95),U=n(703),H=Object(f.b)({name:"alert",initialState:null,reducers:{set:function(e,t){return t.payload},clear:function(e,t){return null}}}),$=H.actions,q=$.set,K=$.clear,M=function(e){return e.alert},V=H.reducer,Q=Object(f.b)({name:"loading",initialState:!1,reducers:{set:function(e,t){return t.payload}}}),X=Q.actions.set,Y=function(e){return e.loading},Z=Q.reducer,ee=Object(f.b)({name:"repos",initialState:[],reducers:{add:function(e,t){return e.concat(t.payload)},clear:function(e,t){return[]}}}),te=ee.actions,ne=te.add,ae=te.clear,re=function(e){return e.repos},ce=ee.reducer,oe=Object(U.a)((function(e){return{root:{flexGrow:1},list:{width:250},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},appBarSpacer:e.mixins.toolbar}}));function ie(e){var t=e.children,n=Object(i.c)(M),c=Object(i.c)(g),o=Object(i.c)(Y),s=Object(i.b)(),l=oe(),m=Object(a.useState)(!1),p=Object(w.a)(m,2),f=p[0],d=p[1],b=function(e){var t=e.type,n=e.key;("keydown"!==t||"Tab"!==n&&"Shift"!==n)&&d(!1)},h=function(){s(K())};return r.a.createElement("div",{className:l.root},r.a.createElement(j.a,null,r.a.createElement(z.a,null,r.a.createElement(S.a,{edge:"start",className:l.menuButton,color:"inherit",onClick:function(){null!=c&&d(!0)}},r.a.createElement(G.a,null)),r.a.createElement(N.a,{anchor:"left",open:f,onClose:b},r.a.createElement("div",{className:l.list,role:"presentation",onClick:b,onKeyDown:b},r.a.createElement(W.a,null,r.a.createElement(_.a,{button:!0,onClick:function(){return s(ae())}},r.a.createElement(B.a,null,r.a.createElement(R.a,null)),r.a.createElement(T.a,{primary:"Sync account"})),r.a.createElement(_.a,{button:!0,onClick:function(){return s(v())}},r.a.createElement(B.a,null,r.a.createElement(D.a,null)),r.a.createElement(T.a,{primary:"Log out"}))))),r.a.createElement(L.a,{variant:"h6",className:l.title},r.a.createElement(C.a,{to:"/home",color:"inherit",component:u.b},"WebEdit")),r.a.createElement(y.a,{alt:null===c||void 0===c?void 0:c.name,src:null===c||void 0===c?void 0:c.avatar}))),r.a.createElement("main",{className:l.content},r.a.createElement("div",{className:l.appBarSpacer}),r.a.createElement(A.a,{style:{visibility:o?"visible":"hidden"}}),r.a.createElement(O.a,{maxWidth:"lg",className:l.container},t,r.a.createElement(I.a,{open:null!=n,autoHideDuration:6e3,onClose:h},n&&r.a.createElement(k.a,{onClose:h,severity:n.severity},n.message)))))}var se=n(34),le=n.n(se),ue=n(106),me=n(66),pe=n(712),fe=n(373),de=n.n(fe),be=n(355),he=n.n(be),ve=n(372),ge=n(379),xe=n(245),Ee=n(381),we="https://api.github.com",ke="application/vnd.github.v3+json";function je(e,t,n){return ye.apply(this,arguments)}function ye(){return(ye=Object(me.a)(le.a.mark((function e(t,n,a){var r,c;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(we,"/repos/").concat(n.owner,"/").concat(n.name,"/contents/").concat(a),{headers:{Authorization:"token ".concat(t),Accept:ke}});case 2:return r=e.sent,e.next=5,r.json();case 5:if(c=e.sent,r.ok){e.next=8;break}throw new Error(c.message);case 8:return e.abrupt("return",{text:atob(c.content),sha:c.sha});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e,t,n,a){return Ne.apply(this,arguments)}function Ne(){return(Ne=Object(me.a)(le.a.mark((function e(t,n,a,r){var c,o;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(we,"/repos/").concat(n.owner,"/").concat(n.name,"/contents/").concat(a),{method:"PUT",body:JSON.stringify({message:r.message||"Updates",content:btoa(r.text),sha:r.sha}),headers:{Authorization:"token ".concat(t),Accept:ke}});case 2:return c=e.sent,e.next=5,c.json();case 5:if(o=e.sent,c.ok){e.next=8;break}throw new Error(o.message);case 8:return e.abrupt("return",{sha:o.content.sha});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Se(e){return Ae.apply(this,arguments)}function Ae(){return(Ae=Object(Ee.a)(le.a.mark((function e(t){var n,a,r,c,o,i,s,l,u;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="".concat(we,"/user/repos?sort=pushed&per_page=").concat(50);case 1:if(!n){e.next=31;break}return e.next=4,Object(xe.a)(fetch(n,{headers:{Authorization:"token ".concat(t),Accept:ke}}));case 4:return c=e.sent,e.next=7,Object(xe.a)(c.json());case 7:if(o=e.sent,c.ok){e.next=10;break}throw new Error(o.message);case 10:i=Object(ue.a)(o),e.prev=11,i.s();case 13:if((s=i.n()).done){e.next=19;break}return l=s.value,e.next=17,{owner:l.owner.login,name:l.name,description:l.description,active:!l.archived&&!l.disabled};case 17:e.next=13;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(11),i.e(e.t0);case 24:return e.prev=24,i.f(),e.finish(24);case 27:u=c.headers.get("link"),n=null===u||void 0===u||null===(a=u.match(Object(ge.a)(/<((?:(?!>)[\s\S])+)>;[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*rel="next"/,{url:1})))||void 0===a||null===(r=a.groups)||void 0===r?void 0:r.url,e.next=1;break;case 31:case"end":return e.stop()}}),e,null,[[11,21,24,27]])})))).apply(this,arguments)}function Ce(e){return We.apply(this,arguments)}function We(){return(We=Object(me.a)(le.a.mark((function e(t){var n,a;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(we,"/user"),{headers:{Authorization:"token ".concat(t),Accept:ke}});case 2:return n=e.sent,e.next=5,n.json();case 5:if(a=e.sent,n.ok){e.next=8;break}throw new Error(a.message);case 8:return e.abrupt("return",{name:a.name||a.login,avatar:a.avatar_url,token:t,scopes:n.headers.get("x-oauth-scopes").split(", ")});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var _e=Object(U.a)((function(e){return{icon:{marginRight:e.spacing(1)},submit:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)}}}));function Be(){var e,t=_e(),n=Object(l.h)(),c=n.owner,o=n.name,s=n.fileName,u=Object(i.c)(g),m=Object(i.c)(re),p=Object(i.c)(Y),f=Object(i.b)(),d=Object(a.useState)(),b=Object(w.a)(d,2),h=b[0],v=b[1],x=null===(e=m.find((function(e){var t=e.repo;return t.owner===c&&t.name===o})))||void 0===e?void 0:e.config[s],E=function(){var e=Object(me.a)(le.a.mark((function e(t,n){var a,r,i,l,m,d,b;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p){e.next=2;break}return e.abrupt("return");case 2:return f(X(!0)),a={owner:c,name:o},e.prev=4,e.next=7,je(u.token,a,s);case 7:i=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),r={message:e.t0.message,severity:"error"};case 13:if(!i){e.next=26;break}return l=JSON.parse(i.text),(x.path?ve.search(l,x.path):l).unshift(h),m={text:JSON.stringify(l,null,2),sha:i.sha},e.prev=18,e.next=21,Oe(u.token,a,s,m);case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(18),r={message:e.t1.message,severity:"error"};case 26:if(!r){v(null),d=Object(ue.a)(n.target.getElementsByTagName("textarea"));try{for(d.s();!(b=d.n()).done;)b.value.value=""}catch(t){d.e(t)}finally{d.f()}r={message:"Item saved",severity:"success"}}f(q(r)),f(X(!1));case 29:case"end":return e.stop()}}),e,null,[[4,10],[18,23]])})));return function(t,n){return e.apply(this,arguments)}}();return x?r.a.createElement(r.a.Fragment,null,r.a.createElement(he.a,{disabled:p,schema:x.schema,uiSchema:x.ui,formData:h,onChange:function(e){v(e.formData)},onSubmit:E},r.a.createElement(pe.a,{variant:"extended",type:"submit",color:"primary",disabled:p,className:t.submit},r.a.createElement(de.a,{className:t.icon})," Save"))):r.a.createElement(l.a,{to:"/home"})}var Te=n(374),Fe=n(246),De=n(713),Pe=n(714),Ge=n(375),Ie=n.n(Ge),Je=n(376),Re=n.n(Je),ze=Object(U.a)((function(e){return{root:{display:"inline-flex",marginLeft:e.spacing(1),marginRight:e.spacing(1),marginBottom:e.spacing(1)},details:{display:"flex",flexDirection:"column"},content:{flex:"1 0 auto"},controls:{display:"flex",alignItems:"center",paddingLeft:e.spacing(1),paddingBottom:e.spacing(1)}}}));function Le(e){var t=e.repo,n=e.fileName,a=ze(),c="https://github.com/".concat(t.owner,"/").concat(t.name),o="/edit/".concat(t.owner,"/").concat(t.name,"/").concat(n);return r.a.createElement(De.a,{className:a.root},r.a.createElement("div",{className:a.details},r.a.createElement(Pe.a,{className:a.content},r.a.createElement(L.a,{component:"h5",variant:"h5"},t.owner," / ",t.name," / ",n.replace(/\.json$/,"")),r.a.createElement(L.a,{variant:"subtitle1",color:"textSecondary"},t.description)),r.a.createElement("div",{className:a.controls},r.a.createElement(C.a,{to:o,component:u.b},r.a.createElement(S.a,{"aria-label":"Edit file"},r.a.createElement(Ie.a,null))),r.a.createElement(C.a,{href:c,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(S.a,{"aria-label":"Open repository on GitHub"},r.a.createElement(Re.a,null))))))}var Ue=[{extension:"json",loader:JSON.parse},{extension:"yaml",loader:Fe.a},{extension:"yml",loader:Fe.a}];function He(){var e=Object(i.c)(g),t=Object(i.c)(re),n=Object(i.b)();return Object(a.useEffect)((function(){Object(me.a)(le.a.mark((function a(){var r,c,o,i,s,l,u,m,p;return le.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.length&&e.token){a.next=2;break}return a.abrupt("return");case 2:n(X(!0)),r=Se(e.token),c=[],o=!0,i=!1,a.prev=7,l=function(){var t=p;if(!t.active)return"continue";var a,r=Object(ue.a)(Ue);try{var o=function(){var r=a.value,o=r.extension,i=r.loader;c.push(je(e.token,t,".webedit.".concat(o)).then((function(e){var a=i(e.text);n(ne({repo:t,config:a}))})).catch((function(e){return"Not Found"===e.message||"This repository is empty."===e.message?Promise.resolve():Promise.reject(e)})))};for(r.s();!(a=r.n()).done;)o()}catch(i){r.e(i)}finally{r.f()}},u=Object(Te.a)(r);case 10:return a.next=12,u.next();case 12:return m=a.sent,o=m.done,a.next=16,m.value;case 16:if(p=a.sent,o){a.next=24;break}if("continue"!==l()){a.next=21;break}return a.abrupt("continue",21);case 21:o=!0,a.next=10;break;case 24:a.next=30;break;case 26:a.prev=26,a.t0=a.catch(7),i=!0,s=a.t0;case 30:if(a.prev=30,a.prev=31,o||null==u.return){a.next=35;break}return a.next=35,u.return();case 35:if(a.prev=35,!i){a.next=38;break}throw s;case 38:return a.finish(35);case 39:return a.finish(30);case 40:return a.prev=40,a.next=43,Promise.all(c);case 43:a.next=48;break;case 45:a.prev=45,a.t1=a.catch(40),n(q({message:a.t1.message,severity:"error"}));case 48:n(X(!1));case 49:case"end":return a.stop()}}),a,null,[[7,26,30,40],[31,,35,39],[40,45]])})))()}),[e,t,n]),t.flatMap((function(e){var t=e.repo,n=e.config;return Object.entries(n).map((function(e){var n=Object(w.a)(e,2),a=n[0],r=n[1];return{repo:t,fileName:a,settings:r,key:"".concat(t.owner,"/").concat(t.name,"/").concat(a)}}))})).map((function(e){return r.a.createElement(Le,e)}))}var $e=n(336),qe=n(349),Ke=n(377),Me=n.n(Ke),Ve=Object(U.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},title:{textAlign:"center"},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function Qe(){var e=Object(l.f)(),t=Object(l.g)(),n=Object(i.b)(),c=Object(i.c)(Y),o=Object(a.useState)(""),s=Object(w.a)(o,2),u=s[0],m=s[1],p=Object(a.useState)(),f=Object(w.a)(p,2),d=f[0],b=f[1],v=Ve(),g=function(){var a=Object(me.a)(le.a.mark((function a(r){var c,o,i,s;return le.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r.preventDefault(),n(X(!0)),a.prev=2,a.next=5,Ce(u);case 5:c=a.sent,a.next=11;break;case 8:a.prev=8,a.t0=a.catch(2),o=a.t0.message;case 11:n(X(!1)),c&&!c.scopes.some((function(e){return e.includes("repo")}))&&(o="Access token must have repo or public_repo scope"),o?b(o):(n(h(c)),e.push((null===(i=t.state)||void 0===i||null===(s=i.from)||void 0===s?void 0:s.pathname)||"/"));case 14:case"end":return a.stop()}}),a,null,[[2,8]])})));return function(e){return a.apply(this,arguments)}}();return r.a.createElement(O.a,{component:"main",maxWidth:"xs"},r.a.createElement("div",{className:v.paper},r.a.createElement(y.a,{className:v.avatar},r.a.createElement(Me.a,null)),r.a.createElement(L.a,{component:"h1",variant:"h5",className:v.title},"Provide a Github personal access token to continue"),r.a.createElement("form",{className:v.form,noValidate:!0,onSubmit:g},r.a.createElement(qe.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"github_personal_access_token",name:"github_personal_access_token",label:"Github personal access token",type:"password",autoComplete:"github_personal_access_token",autoFocus:!0,value:u,onChange:function(e){m(e.target.value)},disabled:c,error:null!=d,helperText:d}),r.a.createElement($e.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:v.submit,disabled:c},"Sign In"))))}var Xe=function(){return r.a.createElement(l.a,{to:"/home"})};function Ye(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,null),r.a.createElement(u.a,null,r.a.createElement(ie,null,r.a.createElement(l.b,{exact:!0,path:"/",component:Xe}),r.a.createElement(E,{exact:!0,path:"/home",component:He}),r.a.createElement(E,{exact:!0,path:"/edit/:owner/:name/:fileName",component:Be}),r.a.createElement(l.b,{exact:!0,path:"/login",component:Qe}))))}var Ze=n(39),et=n(71),tt=n(378),nt=Object(Ze.c)({alert:V,loading:Z,user:x,repos:ce}),at={key:"root",storage:tt},rt=Object(f.a)({reducer:Object(et.g)(at,(function(e,t){return t.type===v.type&&(at.storage.removeItem("persist:".concat(at.key)),e=void 0),nt(e,t)})),middleware:Object(f.c)({serializableCheck:{ignoredActions:[et.a,et.f,et.b,et.c,et.d,et.e]}})}),ct=Object(et.h)(rt),ot=rt,it=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function st(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(r.a.createElement(i.a,{store:ot},r.a.createElement(s.a,{persistor:ct,loading:null},r.a.createElement(Ye,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/webedit",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/webedit","/service-worker.js");it?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):st(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):st(t,e)}))}}()}},[[660,1,2]]]);
//# sourceMappingURL=main.d0025cd7.chunk.js.map